<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tusmo Pro</title>
    <style>
        body { background-color: #1a1a1a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin: 0; padding: 10px; min-height: 100vh; box-sizing: border-box; }
        
        .btn-home { position: absolute; top: 15px; left: 15px; background: #444; color: white; text-decoration: none; padding: 10px; border-radius: 50%; font-size: 1.2rem; z-index: 100; width: 45px; height: 45px; display: flex; justify-content: center; align-items: center; }

        h1 { font-size: 2.2rem; margin: 10px 0; color: #00d4ff; letter-spacing: 5px; }
        #message { height: 35px; color: #00d4ff; font-weight: bold; font-size: 1.1rem; }
        
        .grid { display: grid; grid-template-rows: repeat(6, 1fr); gap: 8px; width: 92vw; max-width: 380px; margin-bottom: 15px; }
        .row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .cell { aspect-ratio: 1/1; border: 2px solid #444; border-radius: 8px; display: flex; justify-content: center; align-items: center; font-size: 2.2rem; font-weight: bold; text-transform: uppercase; transition: background 0.3s; }
        
        .correct { background-color: #e74c3c; border-color: #e74c3c; }
        .present { background-color: #f1c40f; border-color: #f1c40f; border-radius: 50%; }
        .absent { background-color: #34495e; border-color: #34495e; }

        /* Style pour les touches des lettres absentes : grises mais cliquables */
        .key.key-absent { background-color: #222 !important; color: #555; }

        .keyboard { display: flex; flex-direction: column; gap: 8px; width: 100%; max-width: 500px; margin-top: auto; padding-bottom: 10px; }
        .kb-row { display: flex; justify-content: center; gap: 6px; }
        .key { background: #444; border: none; color: white; padding: 18px 0; border-radius: 8px; font-weight: bold; font-size: 1.2rem; cursor: pointer; flex: 1; min-width: 32px; touch-action: manipulation; transition: 0.2s; }
        .key-wide { flex: 2.5; background: #00d4ff; color: #1a1a1a; font-size: 0.9rem; }

        #result-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); flex-direction:column; align-items:center; justify-content:center; z-index:200; text-align: center; }
        .result-card { background:#2c3e50; padding:40px; border-radius:20px; border:2px solid #00d4ff; box-shadow: 0 0 20px #00d4ff55; }
        .btn-menu { margin-top: 25px; display: inline-block; padding: 15px 30px; background: #00d4ff; color: black; text-decoration: none; border-radius: 10px; font-weight: bold; font-size: 1.1rem; }
    </style>
</head>
<body>
    <a href="index.html" class="btn-home">üè†</a>
    <h1>TUSMO</h1>
    <div id="message"></div>
    <div class="grid" id="grid"></div>

    <div class="keyboard">
        <div class="kb-row">
            <button class="key" id="key-A" onclick="addLetter('A')">A</button><button class="key" id="key-Z" onclick="addLetter('Z')">Z</button><button class="key" id="key-E" onclick="addLetter('E')">E</button><button class="key" id="key-R" onclick="addLetter('R')">R</button><button class="key" id="key-T" onclick="addLetter('T')">T</button><button class="key" id="key-Y" onclick="addLetter('Y')">Y</button><button class="key" id="key-U" onclick="addLetter('U')">U</button><button class="key" id="key-I" onclick="addLetter('I')">I</button><button class="key" id="key-O" onclick="addLetter('O')">O</button><button class="key" id="key-P" onclick="addLetter('P')">P</button>
        </div>
        <div class="kb-row">
            <button class="key" id="key-Q" onclick="addLetter('Q')">Q</button><button class="key" id="key-S" onclick="addLetter('S')">S</button><button class="key" id="key-D" onclick="addLetter('D')">D</button><button class="key" id="key-F" onclick="addLetter('F')">F</button><button class="key" id="key-G" onclick="addLetter('G')">G</button><button class="key" id="key-H" onclick="addLetter('H')">H</button><button class="key" id="key-J" onclick="addLetter('J')">J</button><button class="key" id="key-K" onclick="addLetter('K')">K</button><button class="key" id="key-L" onclick="addLetter('L')">L</button><button class="key" id="key-M" onclick="addLetter('M')">M</button>
        </div>
        <div class="kb-row">
            <button class="key" id="key-W" onclick="addLetter('W')">W</button><button class="key" id="key-X" onclick="addLetter('X')">X</button><button class="key" id="key-C" onclick="addLetter('C')">C</button><button class="key" id="key-V" onclick="addLetter('V')">V</button><button class="key" id="key-B" onclick="addLetter('B')">B</button><button class="key" id="key-N" onclick="addLetter('N')">N</button>
            <button class="key key-wide" onclick="deleteLetter()">‚å´</button>
            <button class="key key-wide" onclick="submitGuess()">ENTRER</button>
        </div>
    </div>

    <div id="result-overlay">
        <div class="result-card">
            <h2 id="result-title" style="font-size: 2.5rem; margin: 0;"></h2>
            <p id="result-text" style="font-size: 1.2rem; margin: 20px 0;"></p>
            <a href="index.html" class="btn-menu">üè† ACCUEIL</a>
        </div>
    </div>

    <script src="dictionnaire.js"></script>
    <script>
        const startDate = new Date("2023-12-19");
        const today = new Date();
        const diffInDays = Math.floor((today - startDate) / (1000 * 3600 * 24));
        const targetWord = dictionnaire[diffInDays % dictionnaire.length];

        const grid = document.getElementById('grid');
        let currentGuess = "";
        let currentAttempt = 0;
        let isGameOver = false;
        let discoveredLetters = {}; 

        for (let i = 0; i < 6; i++) {
            const row = document.createElement('div'); row.className = 'row';
            for (let j = 0; j < 5; j++) {
                const cell = document.createElement('div'); cell.className = 'cell';
                if(i === 0 && j === 0) cell.innerText = targetWord[0];
                row.appendChild(cell);
            }
            grid.appendChild(row);
        }

        // --- SUPPORT DU CLAVIER PHYSIQUE ---
        window.addEventListener('keydown', (e) => {
            if (isGameOver) return;
            
            const key = e.key.toUpperCase();
            
            // Si c'est une lettre de A √† Z
            if (key.length === 1 && key >= 'A' && key <= 'Z') {
                addLetter(key);
            } 
            // Si c'est la touche retour (effacer)
            else if (e.key === 'Backspace') {
                deleteLetter();
            } 
            // Si c'est la touche Entr√©e
            else if (e.key === 'Enter') {
                submitGuess();
            }
        });

        function addLetter(l) {
            if (isGameOver || currentGuess.length >= 5) return;
            currentGuess += l;
            updateGrid();
        }

        function deleteLetter() {
            if (isGameOver || currentGuess.length === 0) return;
            currentGuess = currentGuess.slice(0, -1);
            updateGrid();
        }

        function updateGrid() {
            const row = grid.children[currentAttempt];
            for (let i = 0; i < 5; i++) {
                if (i > 0 || currentAttempt > 0) {
                    row.children[i].innerText = currentGuess[i] || "";
                }
            }
        }

        function submitGuess() {
            if (isGameOver || currentGuess.length !== 5) return;
            checkGuess(currentGuess);
            currentGuess = "";
            currentAttempt++;
        }

        function checkGuess(guess) {
            const row = grid.children[currentAttempt];
            const targetArr = targetWord.split('');
            
            for (let i = 0; i < 5; i++) {
                row.children[i].innerText = guess[i];
                if (guess[i] === targetWord[i]) {
                    row.children[i].classList.add('correct');
                    targetArr[i] = null;
                    discoveredLetters[guess[i]] = 'correct';
                }
            }
            
            for (let i = 0; i < 5; i++) {
                if (!row.children[i].classList.contains('correct')) {
                    const idx = targetArr.indexOf(guess[i]);
                    if (idx !== -1) { 
                        row.children[i].classList.add('present'); 
                        targetArr[idx] = null;
                        if (discoveredLetters[guess[i]] !== 'correct') discoveredLetters[guess[i]] = 'present';
                    } else { 
                        row.children[i].classList.add('absent'); 
                        if (!discoveredLetters[guess[i]]) discoveredLetters[guess[i]] = 'absent';
                    }
                }
            }

            updateKeyboardUI();

            if (guess === targetWord) showEndScreen(true);
            else if (currentAttempt === 5) showEndScreen(false);
        }

        function updateKeyboardUI() {
            for (let letter in discoveredLetters) {
                const keyBtn = document.getElementById(`key-${letter}`);
                if (keyBtn && discoveredLetters[letter] === 'absent') {
                    // On change juste la couleur sans bloquer le clic
                    keyBtn.classList.add('key-absent');
                }
            }
        }

        function showEndScreen(win) {
            isGameOver = true;
            document.getElementById('result-overlay').style.display = 'flex';
            document.getElementById('result-title').innerText = win ? "GAGN√â ! üéâ" : "PERDU ! üíÄ";
            document.getElementById('result-text').innerText = win ? `Bien jou√© !` : `Le mot √©tait : ${targetWord}`;
        }
    </script>
</body>
</html>
