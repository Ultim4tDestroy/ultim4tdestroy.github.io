<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2048 Pro</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3446497416600658"
     crossorigin="anonymous"></script>
    <link rel="icon" type="image/jpeg" href="favicon.jpeg">
    <link rel="apple-touch-icon" href="favicon.jpeg">
    <style>
        body { background-color: #1a1a1a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; touch-action: none; overflow: hidden; }
        
        /* Bouton maison uniquement */
        .btn-home { position: absolute; top: 15px; left: 15px; background: #444; color: white; text-decoration: none; padding: 10px; border-radius: 50%; font-size: 1.2rem; z-index: 100; width: 45px; height: 45px; display: flex; justify-content: center; align-items: center; }
        
        #game-container { position: relative; background: #333; border-radius: 10px; padding: 10px; width: 92vw; height: 92vw; max-width: 420px; max-height: 420px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .grid-bg { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 10px; height: 100%; }
        .cell-bg { background: #444; border-radius: 5px; }
        .tile { position: absolute; width: calc(25% - 15px); height: calc(25% - 15px); border-radius: 5px; display: flex; justify-content: center; align-items: center; font-size: 2.2rem; font-weight: bold; transition: all 0.15s ease-in-out; z-index: 10; }
        .tile-2 { background: #eee4da; color: #776e65; } .tile-4 { background: #ede0c8; color: #776e65; }
        .tile-8 { background: #f2b179; color: white; } .tile-16 { background: #f59563; color: white; }
        .tile-32 { background: #f67c5f; color: white; } .tile-64 { background: #f65e3b; color: white; }
        .tile-128 { background: #edcf72; color: white; font-size: 1.8rem; } .tile-256 { background: #edcc61; color: white; font-size: 1.8rem; }
        .tile-512 { background: #edc850; color: white; font-size: 1.8rem; } .tile-1024 { background: #edc53f; color: white; font-size: 1.4rem; }
        .tile-2048 { background: #edc22e; color: white; font-size: 1.4rem; box-shadow: 0 0 15px #edc22e; }
        .score-container { font-size: 2.8rem; margin-bottom: 15px; color: #00d4ff; font-weight: bold; }
    </style>
</head>
<body>
    <a href="index.html" class="btn-home">üè†</a>
    <div class="score-container">Score: <span id="score">0</span></div>
    <div id="game-container">
        <div class="grid-bg">
            <div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div>
            <div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div>
            <div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div>
            <div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div><div class="cell-bg"></div>
        </div>
        <div id="tiles-layer"></div>
    </div>

    <script>
        const tilesLayer = document.getElementById('tiles-layer');
        const scoreDisplay = document.getElementById('score');
        const container = document.getElementById('game-container');
        let board = Array(16).fill(null);
        let score = 0;

        function updatePos(tile, index) {
            const size = container.clientWidth - 20;
            const step = size / 4;
            const x = (index % 4) * step + 10;
            const y = Math.floor(index / 4) * step + 10;
            tile.element.style.left = x + 'px';
            tile.element.style.top = y + 'px';
        }

        function addTile() {
            const empty = board.map((v, i) => v === null ? i : null).filter(v => v !== null);
            if (empty.length > 0) {
                const idx = empty[Math.floor(Math.random() * empty.length)];
                const val = Math.random() < 0.9 ? 2 : 4;
                const el = document.createElement('div');
                el.className = `tile tile-${val}`; el.innerHTML = val;
                tilesLayer.appendChild(el);
                board[idx] = { value: val, element: el };
                updatePos(board[idx], idx);
            }
        }

        function slide(line) {
            let arr = line.filter(t => t !== null);
            for (let i = 0; i < arr.length - 1; i++) {
                if (arr[i].value === arr[i + 1].value) {
                    arr[i].value *= 2; score += arr[i].value; scoreDisplay.innerHTML = score;
                    tilesLayer.removeChild(arr[i+1].element);
                    arr[i].element.innerHTML = arr[i].value; arr[i].element.className = `tile tile-${arr[i].value}`;
                    arr.splice(i + 1, 1);
                }
            }
            while (arr.length < 4) arr.push(null);
            return arr;
        }

        function move(dir) {
            let moved = false;
            let oldBoard = JSON.stringify(board.map(b => b ? b.value : 0));
            if (dir === 'left' || dir === 'right') {
                for (let i = 0; i < 4; i++) {
                    let row = [board[i*4], board[i*4+1], board[i*4+2], board[i*4+3]];
                    if (dir === 'right') row.reverse();
                    let newRow = slide(row);
                    if (dir === 'right') newRow.reverse();
                    for (let j = 0; j < 4; j++) { board[i*4+j] = newRow[j]; if(board[i*4+j]) updatePos(board[i*4+j], i*4+j); }
                }
            } else {
                for (let i = 0; i < 4; i++) {
                    let col = [board[i], board[i+4], board[i+8], board[i+12]];
                    if (dir === 'down') col.reverse();
                    let newCol = slide(col);
                    if (dir === 'down') newCol.reverse();
                    for (let j = 0; j < 4; j++) { board[i+j*4] = newCol[j]; if(board[i+j*4]) updatePos(board[i+j*4], i+j*4); }
                }
            }
            if (oldBoard !== JSON.stringify(board.map(b => b ? b.value : 0))) setTimeout(addTile, 150);
        }

        let touchStartX = 0, touchStartY = 0;
        document.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; touchStartY = e.changedTouches[0].screenY; }, false);
        document.addEventListener('touchend', e => {
            let x = e.changedTouches[0].screenX - touchStartX;
            let y = e.changedTouches[0].screenY - touchStartY;
            if (Math.abs(x) > Math.abs(y)) { if (Math.abs(x) > 30) move(x > 0 ? 'right' : 'left'); }
            else { if (Math.abs(y) > 30) move(y > 0 ? 'down' : 'up'); }
        }, false);

        window.addEventListener('keydown', e => { if(e.key.includes('Arrow')) move(e.key.replace('Arrow','').toLowerCase()); });
        addTile(); addTile();
    </script>
</body>
</html>



